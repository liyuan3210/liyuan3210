# 行为型模式

**1.模板模式**

基本介绍

```
1) 模板方法模式(Template Method Pattern),又叫模板模式(Template Pattern),z
在一个抽象类公开定义了执行它的方法的模板。它的子类可以按需要重写方法
实现,但调用将以抽象类中定义的方式进行。
2) 简单说,模板方法模式 定义一个操作中的算法的骨架,而将一些步骤延迟到子
类中,使得子类可以不改变一个算法的结构,就可以重定义该算法的某些特定
步骤
3) 这种类型的设计模式属于行为型模式。


```

对原理类图的说明-即(模板方法模式的角色及职责)

```
1) AbstractClass 抽象类, 类中实现了模板方法(template),定义了算法的骨
架,具体子类需要去实现 其它的抽象方法operationr2,3,4
2) ConcreteClass 实现抽象方法operationr2,3,4, 以完成算法中特点子类的步
骤
```

模板方法模式的**钩子**

```
1) 在模板方法模式的父类中,我们可以定义一个方法,它默认不做任何事,子类可以
视情况要不要覆盖它,该方法称为“钩子”。
2) 还是用上面做豆浆的例子来讲解,比如,我们还希望制作纯豆浆,不添加任何的配
料,请使用钩子方法对前面的模板方法进行改造
```

实例:com.liyuan3210.design23.acts.template2

**2.命令模式**

基本介绍

```
1) 命令模式(Command Pattern):在软件设计中,我们经常需要向某些对象发送请求,但是并不知道请求的接收者是谁,也不知道被请求的操作是哪个,我们只需在程序运行时指定具体的请求接收者即可,此时,可以使用命令模式来进行设计
2) 命名模式使得请求发送者与请求接收者消除彼此之间的耦合,让对象之间的调用关系更加灵活,实现解耦。
3) 在命名模式中,会将一个请求封装为一个对象,以便使用不同参数来表示不同的请求(即命名),同时命令模式也支持可撤销的操作。
4) 通俗易懂的理解:将军发布命令,士兵去执行。其中有几个角色:将军(命令发布者)、士兵(命令的具体执行者)、命令(连接将军和士兵)。Invoker是调用者(将军),Receiver是被调用者(士兵),MyCommand是命令,实现了Command接口,持有接收对象
```

对原理类图的说明-即(命名模式的角色及职责)
1)Invoker 是调用者角色
2)Command: 是命令角色,需要执行的所有命令都在这里,可以是接口或抽象类
3)Receiver: 接受者角色,知道如何实施和执行一个请求相关的操作
4)ConcreteCommand: 将一个接受者对象与一个动作绑定,调用接受者相应的操作,实现execute
![](img/command.png)

实例:om.liyuan3210.design23.acts.command2



**3.访问者模式**

场景介绍:

```
1) 将观众分为男人和女人,对歌手进行测评,当看完某个歌手表演后,得到他们对该歌手不同的评价(评价 有不同的种类,比如 成功、失败 等)
```

访问者模式基本介绍

```
1) 访问者模式(Visitor Pattern),封装一些作用于某种数据结构的各元素的操作,它可以在不改变数据结构的前提下定义作用于这些元素的新的操作。
2) 主要将数据结构与数据操作分离,解决 数据结构和操作耦合性问题
3) 访问者模式的基本工作原理是:在被访问的类里面加一个对外提供接待访问者的接口
4) 访问者模式主要应用场景是:需要对一个对象结构中的对象进行很多不同操作
(这些操作彼此没有关联),同时需要避免让这些操作"污染"这些对象的类,可以选用访问者模式解决
```

![](img/visitor-1.png)

双分派

应用案例的小结
-上面提到了双分派,所谓双分派是指不管类怎么变化,我们都能找到期望的方法运行。
双分派意味着得到执行的操作取决于请求的种类和两个接收者的类型

- 以上述实例为例,假设我们要添加一个Wait的状态类,考察Man类和Woman类的反
应,由于使用了双分派, 只需增加一个Action子类即可在客户端调用即可,不
需要改动任何其他类的代码 。

实例:



**4.迭代器模式(实现系统Iterator接口)**

基本介绍
1) 迭代器模式(Iterator Pattern)是常用的设计模式,属于行为型模式
2) 如果我们的 **集合元素是用不同的方式实现** 的,有数组,还有java的集合类,
或者还有其他方式,当客户端要 遍历这些集合元素 的时候就要使用多种遍历
方式,而且还会暴露元素的内部结构,可以考虑使用迭代器模式解决。
3) 迭代器模式,提供一种遍历集合元素的统一接口,用一致的方法遍历集合元素,
不需要知道集合对象的底层表示,即:**不暴露其内部的结构**。

实例:com.liyuan3210.design23.acts.iterator2

**5.观察者模式**

天气预报项目需求,具体要求如下:

```
1) 气象站可以将每天测量到的温度,湿度,气压等等以公告的形式发布出去(比如发布到自己的网站或第三方)。
2) 需要设计开放型API,便于其他第三方也能接入气象站获取数据。
3) 提供温度、气压和湿度的接口
4) 测量数据更新时,要能实时的通知给第三方
```

**主要有两个接口及实现类:**

Subject: 气象局

Observer: 第三方网站/用户

观察者模式的好处

```
1) 观察者模式设计后,会以集合的方式来管理用户(Observer),包括注册,移除和通知。
2) 这样,我们增加观察者(这里可以理解成一个新的公告板),就不需要去修改核心类WeatherData不会修改代码,遵守了ocp原则。
```

